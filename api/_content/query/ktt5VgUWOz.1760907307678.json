{"_path":"/tutorials/microsoft-teams-messages-webhook-workflow","_dir":"tutorials","_draft":false,"_partial":false,"_locale":"","title":"Sending messages to a Microsoft Teams channel using workflows via webhook","description":"Sending messages, e.g., AdaptiveCard, to a Microsoft Teams channel using workflows via webhook","id":"microsoft-teams-messages-webhook-workflow","path":"/tutorials/microsoft-teams-messages-webhook-workflow","created":"2024-09-14","updated":"2024-09-14","author":"Simon Scholz","tags":["Microsoft Teams","webhook","messages","Microsoft"],"vgWort":"vg09.met.vgwort.de/na/2a1886dd3feb40a8b052ffccfc81e114","readingTime":{"text":"4 min read","minutes":3.62,"time":217200,"words":724},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It is really helpful to automatically send messages to your messenger.\nIn terms of Microsoft Teams workflows can be created, which react upon a webhook.\nThis is the newer approach of sending messages compared to the "},{"type":"element","tag":"a","props":{"href":"https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/connectors-using?tabs=cURL%2Ctext1#message-card-reference","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"deprecated Microsoft 365 connectors"}]},{"type":"text","value":".\nSince the "},{"type":"element","tag":"a","props":{"href":"https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/connectors-using?tabs=cURL%2Ctext1#message-card-reference","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"workflows"}]},{"type":"text","value":" for sending messages via webhook do not work out of the box right now, due to "},{"type":"element","tag":"a","props":{"href":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"this issue"}]},{"type":"text","value":", I thought I write a tutorial on how to resolve this and about creative nice AdaptiveCards."}]},{"type":"element","tag":"h2","props":{"id":"creating-a-workflow"},"children":[{"type":"text","value":"Creating a Workflow"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First choose a channel you´d want to create a workflow for:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow channel context menu","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-channel-context-menu.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the workflow creation dialog "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Post to a channel when a webhook request is received"}]},{"type":"text","value":" can be clicked."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow creation dialog","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-creation-dialog.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then a name can be specified for the workflow:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow name dialog","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-name-dialog.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After hitting next the Microsoft Teams Team and Channel can be chosen, but usally is already preselected, since the context menu of the channel has been used to create the workflow."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"add workflow to channel dialog","src":"/tutorials/microsoft-teams-messages-webhook-workflow/add-workflow-to-channel-dialog.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then the workflow will be created and the workflow´s webhook url can be copied:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow created dialog with webhook copy","src":"/tutorials/microsoft-teams-messages-webhook-workflow/copy-workflow-webhook-link-dialog.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"creating-an-adaptivecard"},"children":[{"type":"text","value":"Creating an AdaptiveCard"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In general you can also just send plain text to a channel, but an AdaptiveCard gives you way more opportunities, e.g., title, sections and even action buttons."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default the workflow also expects an AdaptiveCard as payload."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"But it is really convenient that Microsoft came up with a designer for AdaptiveCards: "},{"type":"element","tag":"a","props":{"href":"https://adaptivecards.io/designer/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"https://adaptivecards.io/designer/"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With this designer you can customize AdaptiveCards according to your needs."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"adaptive card designer","src":"/tutorials/microsoft-teams-messages-webhook-workflow/adaptive-card-designer.png"},"children":[]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Here you can adjust how the card looks like"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Here you can specify variables for the contents"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Finally you´d want to copy the card´s payload"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note that you should turn the designer into "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Preview Mode"}]},{"type":"text","value":" to have the data being applied, when coping the card payload."}]},{"type":"element","tag":"h2","props":{"id":"using-the-webhook-to-send-a-message"},"children":[{"type":"text","value":"Using the webhook to send a message"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The copied webhook url from the former steps can now be hit by a POST reuqest with the copied payload of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"AdaptiveCard"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I usually use Postman for this:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"postman ms teams webhook call","src":"/tutorials/microsoft-teams-messages-webhook-workflow/postman-webhook-call.png"},"children":[]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Paste the webhook url"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Paste the AdaptiveCard payload"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Hit the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Send"}]},{"type":"text","value":" button"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Getting a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"202 Accepted"}]},{"type":"text","value":" response"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alternatively curl can be used:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-light github-dark monokai","code":"curl --location '{your-webhook-url}' \\\n--header 'Content-Type: application/json' \\\n--header 'Cookie: {your-optional-cookie}' \\\n--data '{\n    \"type\": \"AdaptiveCard\",\n    \"body\": [\n        {\n            \"type\": \"TextBlock\",\n            \"size\": \"Medium\",\n            \"weight\": \"Bolder\",\n            \"text\": \"Publish Adaptive Card\"\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"style\": \"Person\",\n                            \"url\": \"https://pbs.twimg.com/profile_images/589879071020023809/SUKQxznj_400x400.jpg\",\n                            \"altText\": \"Simon Scholz\",\n                            \"size\": \"Small\"\n                        }\n                    ],\n                    \"width\": \"auto\"\n                },\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"Simon Scholz\",\n                            \"wrap\": true\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"spacing\": \"None\",\n                            \"text\": \"Created {{DATE(2024-09-14T06:08:39Z,SHORT)}}\",\n                            \"isSubtle\": true,\n                            \"wrap\": true\n                        }\n                    ],\n                    \"width\": \"stretch\"\n                }\n            ]\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Thanks for reading my tutorials, I hope you enjoy them so far.\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"FactSet\",\n            \"facts\": [\n                {\n                    \"title\": \"Board:\",\n                    \"value\": \"Adaptive Cards\"\n                },\n                {\n                    \"title\": \"List:\",\n                    \"value\": \"Backlog\"\n                },\n                {\n                    \"title\": \"Assigned to:\",\n                    \"value\": \"Simon Scholz\"\n                },\n                {\n                    \"title\": \"Due date:\",\n                    \"value\": \"Not set\"\n                }\n            ]\n        }\n    ],\n    \"actions\": [\n        {\n            \"type\": \"Action.ShowCard\",\n            \"title\": \"Set due date\",\n            \"card\": {\n                \"type\": \"AdaptiveCard\",\n                \"body\": [\n                    {\n                        \"type\": \"Input.Date\",\n                        \"id\": \"dueDate\"\n                    },\n                    {\n                        \"type\": \"Input.Text\",\n                        \"id\": \"comment\",\n                        \"placeholder\": \"Add a comment\",\n                        \"isMultiline\": true\n                    }\n                ],\n                \"actions\": [\n                    {\n                        \"type\": \"Action.Submit\",\n                        \"title\": \"OK\"\n                    }\n                ],\n                \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\"\n            }\n        },\n        {\n            \"type\": \"Action.OpenUrl\",\n            \"title\": \"View\",\n            \"url\": \"https://adaptivecards.io\"\n        }\n    ],\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n    \"version\": \"1.6\"\n}'\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" --location"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" '{your-webhook-url}'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"--header "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'Content-Type: application/json'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"--header "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'Cookie: {your-optional-cookie}'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"--data "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    \"type\": \"AdaptiveCard\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    \"body\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"TextBlock\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"size\": \"Medium\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"weight\": \"Bolder\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"text\": \"Publish Adaptive Card\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"ColumnSet\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"columns\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"type\": \"Column\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"items\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"type\": \"Image\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"style\": \"Person\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"url\": \"https://pbs.twimg.com/profile_images/589879071020023809/SUKQxznj_400x400.jpg\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"altText\": \"Simon Scholz\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"size\": \"Small\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"width\": \"auto\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"type\": \"Column\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"items\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"type\": \"TextBlock\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"weight\": \"Bolder\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"text\": \"Simon Scholz\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"wrap\": true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"type\": \"TextBlock\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"spacing\": \"None\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"text\": \"Created {{DATE(2024-09-14T06:08:39Z,SHORT)}}\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"isSubtle\": true,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                            \"wrap\": true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"width\": \"stretch\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"TextBlock\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"text\": \"Thanks for reading my tutorials, I hope you enjoy them so far.\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"wrap\": true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"FactSet\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"facts\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"title\": \"Board:\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"value\": \"Adaptive Cards\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"title\": \"List:\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"value\": \"Backlog\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"title\": \"Assigned to:\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"value\": \"Simon Scholz\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"title\": \"Due date:\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    \"value\": \"Not set\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    \"actions\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"Action.ShowCard\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"title\": \"Set due date\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"card\": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                \"type\": \"AdaptiveCard\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                \"body\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"type\": \"Input.Date\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"id\": \"dueDate\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"type\": \"Input.Text\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"id\": \"comment\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"placeholder\": \"Add a comment\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"isMultiline\": true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                \"actions\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"type\": \"Action.Submit\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                        \"title\": \"OK\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"                \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"type\": \"Action.OpenUrl\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"title\": \"View\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"            \"url\": \"https://adaptivecards.io\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"    \"version\": \"1.6\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"}'\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"check-for-failed-workflow-runs"},"children":[{"type":"text","value":"Check for Failed Workflow runs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As of now the following issues occur when trying to send a message using webhooks: "},{"type":"element","tag":"a","props":{"href":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This causes the workflow to fail even though the webhook call returns a 202 accepted, which actually just means that the request is received and will be processed further."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When you´d click on the workflow you can also see a 28-day run history of your workflow:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow run history","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-run-history.png"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"resolving-failures"},"children":[{"type":"text","value":"Resolving failures"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to resolve the issues mentioned "},{"type":"element","tag":"a","props":{"href":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":", the workflow itself needs to be modified like this:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First you´d want to remove the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Send each adaptive card"}]},{"type":"text","value":" step from the workflow."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Remove send adaptive card step","src":"/tutorials/microsoft-teams-messages-webhook-workflow/remove-send-adaptive-card-step.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then hit the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"+ New step"}]},{"type":"text","value":" button and choose the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Built-in"}]},{"type":"text","value":" tab and the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Data-Operation"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"built in data operation","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-built-in-data-operation.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Data Operation"}]},{"type":"text","value":" the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Compose"}]},{"type":"text","value":" action needs to be chosen:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workflow compose action","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-compose-action.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And the required "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"inputs"}]},{"type":"text","value":" will be "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Body"}]},{"type":"text","value":":"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Body input for compose action","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-compose-action-body-input.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then again hit the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"+ New step"}]},{"type":"text","value":" button and choose the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Standard"}]},{"type":"text","value":" tab and choose "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Microsoft Teams"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Microsoft Teams action","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-microsoft-teams-action.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Mircosoft Teams"}]},{"type":"text","value":" is chosen you have several options, but I´d recomend "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Post card in a chat or channel"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Microsoft Teams send card action","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-microsoft-teams-send-card.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now some properties have to be set for this action:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Microsoft Teams send card action properties","src":"/tutorials/microsoft-teams-messages-webhook-workflow/workflow-post-card-properties.png"},"children":[]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You can either choose user or flow bot, but be aware that user is needed for private chats, since the flow bot won´t have access to it."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Adaptive Card"}]},{"type":"text","value":" must be the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Outputs"}]},{"type":"text","value":" of the former "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Compose"}]},{"type":"text","value":" step"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Finally hit save"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once this has been configured an adaptive card can be properly send to the respective channel using Postman or Curl as depicted in a former section."}]},{"type":"element","tag":"h2","props":{"id":"resulting-message"},"children":[{"type":"text","value":"Resulting Message"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sending the message via Webhook should then look similar to this:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"adaptive card result","src":"/tutorials/microsoft-teams-messages-webhook-workflow/adaptive-card-result.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"But feel free to utilize the "},{"type":"element","tag":"a","props":{"href":"https://adaptivecards.io/designer/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"designer"}]},{"type":"text","value":" to craft your own."}]},{"type":"element","tag":"h2","props":{"id":"sources"},"children":[{"type":"text","value":"Sources"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://adaptivecards.io/designer/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"https://adaptivecards.io/designer/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"https://techcommunity.microsoft.com/t5/teams-developer/error-while-running-teams-workflow-for-sending-message-to-a/m-p/4232037/highlight/true#M10695"}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":3,"depth":3,"links":[{"id":"creating-a-workflow","depth":2,"text":"Creating a Workflow"},{"id":"creating-an-adaptivecard","depth":2,"text":"Creating an AdaptiveCard"},{"id":"using-the-webhook-to-send-a-message","depth":2,"text":"Using the webhook to send a message"},{"id":"check-for-failed-workflow-runs","depth":2,"text":"Check for Failed Workflow runs","children":[{"id":"resolving-failures","depth":3,"text":"Resolving failures"}]},{"id":"resulting-message","depth":2,"text":"Resulting Message"},{"id":"sources","depth":2,"text":"Sources"}]}},"_type":"markdown","_id":"content:tutorials:microsoft-teams-messages-webhook-workflow:index.md","_source":"content","_file":"tutorials/microsoft-teams-messages-webhook-workflow/index.md","_stem":"tutorials/microsoft-teams-messages-webhook-workflow/index","_extension":"md"}